<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebEx Request_V6 by Daiice</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }

    /* ‚îÄ‚îÄ header ‚îÄ‚îÄ */
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }
    .header h1 { font-size:2em; margin-bottom:5px; }
    .header p  { opacity:0.9; font-size:0.95em; }

    /* ‚îÄ‚îÄ input section ‚îÄ‚îÄ */
    .input-section { padding:30px; background:#f8f9fa; }
    .form-group    { margin-bottom:20px; }
    .form-group > label {
      display:block; font-weight:600; margin-bottom:8px; color:#333; font-size:0.95em;
    }

    input[type="text"],
    input[type="date"],
    input[type="number"],
    select {
      width:100%; padding:12px 15px;
      border:2px solid #e0e0e0; border-radius:10px;
      font-size:1em; transition:all 0.3s; background:white;
    }
    input[type="text"]:focus,
    input[type="date"]:focus,
    input[type="number"]:focus,
    select:focus {
      outline:none; border-color:#667eea;
      box-shadow:0 0 0 3px rgba(102,126,234,0.1);
    }

    /* ‚îÄ‚îÄ counter row ‚îÄ‚îÄ */
    .count-row {
      display:flex; align-items:center; gap:16px; flex-wrap:wrap;
    }

    /* Mgt fixed box */
    .mgt-box {
      display:flex; flex-direction:column; gap:6px; min-width:90px;
    }
    .mgt-box .count-label {
      font-weight:700; font-size:0.9em; color:#444;
    }
    .mgt-box .mgt-val {
      text-align:center; font-size:1.35em; font-weight:700;
      padding:10px 8px; border-radius:10px;
      background:#fef3c7; border:2px solid #fcd34d; color:#d97706;
      pointer-events:none; user-select:none;
    }

    .count-box {
      display:flex; flex-direction:column; gap:6px; flex:1; min-width:120px;
    }
    .count-box .count-label {
      font-weight:700; font-size:0.9em; color:#444;
    }
    .count-box .count-label .badge-prod {
      display:inline-block; background:#dcfce7; color:#16a34a;
      padding:2px 9px; border-radius:12px; font-size:0.88em; margin-left:5px;
    }
    .count-box .count-label .badge-uat {
      display:inline-block; background:#dbeafe; color:#2563eb;
      padding:2px 9px; border-radius:12px; font-size:0.88em; margin-left:5px;
    }
    .count-box input[type="number"] {
      text-align:center; font-size:1.35em; font-weight:700; padding:10px 8px;
    }

    /* total badge */
    .total-badge {
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      min-width:90px; padding:10px 18px; border-radius:14px;
      background:#f0fdf4; border:2px solid #86efac; gap:1px; transition:all 0.25s;
    }
    .total-badge .t-label {
      font-size:0.72em; color:#15803d; font-weight:700;
      text-transform:uppercase; letter-spacing:0.6px;
    }
    .total-badge .t-value { font-size:1.4em; font-weight:700; color:#15803d; }
    .total-badge .t-max   { font-size:0.7em;  color:#15803d; opacity:0.7; }

    .total-badge.warn                              { background:#fef2f2; border-color:#fca5a5; }
    .total-badge.warn .t-label,
    .total-badge.warn .t-value,
    .total-badge.warn .t-max                       { color:#dc2626; }

    .error-msg {
      color:#dc2626; font-size:0.83em; font-weight:600;
      margin-top:8px; min-height:20px; transition:opacity 0.2s;
    }
    .error-msg.hidden { opacity:0; }

    /* ‚îÄ‚îÄ INC inputs grid ‚îÄ‚îÄ */
    .inc-inputs {
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(200px, 1fr));
      gap:10px;
    }
    .inc-item { display:flex; flex-direction:column; gap:5px; }

    .inc-label { font-weight:600; color:#667eea; font-size:0.85em; }
    .inc-label .tag-prod {
      background:#dcfce7; color:#16a34a;
      padding:1px 7px; border-radius:10px; font-size:0.85em; margin-left:4px;
    }
    .inc-label .tag-uat {
      background:#dbeafe; color:#2563eb;
      padding:1px 7px; border-radius:10px; font-size:0.85em; margin-left:4px;
    }
    .inc-label .tag-mgt {
      background:#fef3c7; color:#d97706;
      padding:1px 7px; border-radius:10px; font-size:0.85em; margin-left:4px;
    }

    .inc-input {
      padding:10px 12px; border:2px solid #e0e0e0;
      border-radius:8px; font-size:0.95em; transition:all 0.3s;
    }
    .inc-input:focus {
      outline:none; border-color:#667eea;
      box-shadow:0 0 0 3px rgba(102,126,234,0.1);
    }
    .inc-input.required:invalid { border-color:#ef4444; }
    .inc-input.required:valid   { border-color:#10b981; }

    /* ‚îÄ‚îÄ generate button ‚îÄ‚îÄ */
    .generate-btn {
      width:100%; padding:15px;
      background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
      color:white; border:none; border-radius:10px;
      font-size:1.1em; font-weight:600; cursor:pointer;
      transition:all 0.3s; margin-top:20px;
    }
    .generate-btn:hover  { transform:translateY(-2px); box-shadow:0 10px 25px rgba(102,126,234,0.3); }
    .generate-btn:active { transform:translateY(0); }
    .generate-btn:disabled {
      background:#c4c4c4; cursor:not-allowed; transform:none; box-shadow:none;
    }

    /* ‚îÄ‚îÄ output ‚îÄ‚îÄ */
    .output-section       { padding:30px; display:none; }
    .output-section.show  { display:block; }

    .section-card {
      background:white; border:2px solid #e0e0e0;
      border-radius:15px; padding:20px; margin-bottom:20px; transition:all 0.3s;
    }
    .section-card:hover { box-shadow:0 5px 15px rgba(0,0,0,0.1); border-color:#667eea; }

    .section-header {
      display:flex; justify-content:space-between; align-items:center;
      margin-bottom:15px; padding-bottom:10px; border-bottom:2px solid #f0f0f0;
    }
    .section-title { font-weight:600; color:#333; font-size:1.1em; }

    .copy-btn {
      padding:8px 20px; background:#667eea; color:white;
      border:none; border-radius:8px; cursor:pointer;
      font-size:0.9em; font-weight:600; transition:all 0.3s;
    }
    .copy-btn:hover  { background:#5568d3; transform:scale(1.05); }
    .copy-btn.copied { background:#10b981; }

    .content-box {
      background:#f8f9fa; border:1px solid #e0e0e0;
      border-radius:8px; padding:15px; min-height:100px;
      white-space:pre-wrap; font-size:0.95em; line-height:1.6; margin-top:10px;
    }
    .content-box[contenteditable="true"]:focus { outline:2px solid #667eea; background:white; }

    .highlight {
      background-color:#FFFF00; text-decoration:underline;
      padding:2px 4px; border-radius:3px; font-weight:600; color:#FF0000;
    }

    .webex-list {
      font-family:'Courier New', monospace;
      background:#1e293b; color:#e2e8f0;
      padding:20px; border-radius:8px; font-size:0.9em; line-height:1.8;
    }

    /* ‚îÄ‚îÄ responsive ‚îÄ‚îÄ */
    @media (max-width:768px) {
      .inc-inputs  { grid-template-columns:repeat(auto-fill, minmax(150px,1fr)); }
      .section-header { flex-direction:column; gap:10px; align-items:flex-start; }
      .copy-btn    { width:100%; }
      .count-row   { flex-direction:column; align-items:stretch; }
      .mgt-box     { align-self:center; }
      .total-badge { align-self:center; }
    }
  </style>
</head>
<body>
<div class="container">

  <!-- header -->
  <div class="header">
    <h1>üåê WebEx Request_V6 by Daiice</h1>
    <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° WebEx ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
  </div>

  <!-- inputs -->
  <div class="input-section">

    <!-- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà -->
    <div class="form-group">
      <label for="dateInput">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
      <input type="date" id="dateInput">
    </div>

    <!-- Mgt + PROD + UAT counters -->
    <div class="form-group">
      <label>üî¢ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô WebEx (‡∏£‡∏ß‡∏° Mgt + PROD + UAT ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 8):</label>
      <div class="count-row">

        <!-- Mgt = 1 ‡πÄ‡∏™‡∏°‡∏≠ (fixed, ‡∏Å‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ) -->
        <div class="mgt-box">
          <span class="count-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô <span style="display:inline-block;background:#fef3c7;color:#d97706;padding:2px 9px;border-radius:12px;font-size:0.88em;margin-left:5px;">Mgt</span></span>
          <div class="mgt-val">1</div>
        </div>

        <!-- PROD -->
        <div class="count-box">
          <span class="count-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô <span class="badge-prod">PROD</span></span>
          <input type="number" id="prodCount" min="3" max="7" value="4" oninput="onCountChange()">
        </div>

        <!-- UAT -->
        <div class="count-box">
          <span class="count-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô <span class="badge-uat">UAT</span></span>
          <input type="number" id="uatCount" min="1" max="3" value="2" oninput="onCountChange()">
        </div>

        <!-- total badge -->
        <div class="total-badge" id="totalBadge">
          <span class="t-label">‡∏£‡∏ß‡∏°</span>
          <span class="t-value" id="totalValue">7</span>
          <span class="t-max">/ 8</span>
        </div>
      </div>
      <div class="error-msg hidden" id="countError">‚ö†Ô∏è ‡∏£‡∏ß‡∏° Mgt + PROD + UAT ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 8 ‡∏≠‡∏±‡∏ô</div>
    </div>

    <!-- INC fields -->
    <div class="form-group">
      <label>üìã Incident Numbers:</label>
      <div class="inc-inputs" id="incInputs"></div>
    </div>

    <button class="generate-btn" id="generateBtn" onclick="generateText()">‚ú® ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
  </div>

  <!-- output -->
  <div class="output-section" id="outputArea"></div>
</div>

<script>
// ‚îÄ‚îÄ helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const MGT = 1;

function getPROD()  { return Math.max(0, parseInt(document.getElementById('prodCount').value) || 0); }
function getUAT()   { return Math.max(0, parseInt(document.getElementById('uatCount').value)  || 0); }
function getTotal() { return MGT + getPROD() + getUAT(); }

function formatDate(input) {
  const d  = new Date(input);
  const dd = ('0'+d.getDate()).slice(-2);
  const mm = ('0'+(d.getMonth()+1)).slice(-2);
  const yy = (d.getFullYear()+543).toString().slice(-2);
  return `${dd}/${mm}/${yy}`;
}

// ‚îÄ‚îÄ live validation & badge ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function onCountChange() {
  document.getElementById('prodCount').value = getPROD();
  document.getElementById('uatCount').value  = getUAT();

  const total  = getTotal();
  const badge  = document.getElementById('totalBadge');
  const errMsg = document.getElementById('countError');
  const btn    = document.getElementById('generateBtn');

  document.getElementById('totalValue').textContent = total;

  if (total > 8) {
    badge.classList.add('warn');
    errMsg.classList.remove('hidden');
    btn.disabled = true;
  } else {
    badge.classList.remove('warn');
    errMsg.classList.add('hidden');
    btn.disabled = false;
  }

  updateIncInputs();
}

// ‚îÄ‚îÄ build INC fields ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateIncInputs() {
  const prodCount = getPROD();
  const uatCount  = getUAT();
  const container = document.getElementById('incInputs');
  container.innerHTML = '';
  let n = 1;                              // running # ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á

  // Mgt ‡πÄ‡∏™‡∏°‡∏≠ 1 ‡∏≠‡∏±‡∏ô ‚Üí #1
  container.innerHTML += `
    <div class="inc-item">
      <div class="inc-label">#${n} <span class="tag-mgt">Mgt</span> *</div>
      <input type="text" id="incMgt" class="inc-input required" placeholder="INC..." required>
    </div>`;
  n++;

  // PROD ‚Üí #2, #3, ‚Ä¶
  for (let i = 1; i <= prodCount; i++, n++) {
    container.innerHTML += `
      <div class="inc-item">
        <div class="inc-label">#${n} <span class="tag-prod">PROD</span> *</div>
        <input type="text" id="incProd${i}" class="inc-input required" placeholder="INC..." required>
      </div>`;
  }

  // UAT ‚Üí ‡∏ô‡∏±‡∏ö‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å PROD (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á INC)
  for (let u = 1; u <= uatCount; u++, n++) {
    container.innerHTML += `
      <div class="inc-item">
        <div class="inc-label">#${n} <span class="tag-uat">UAT</span></div>
        <input type="text" value="‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏" class="inc-input" disabled style="background:#f0f0f0;color:#999;">
      </div>`;
  }
}

// ‚îÄ‚îÄ copy ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function copyToClipboard(elementId, btnElement) {
  const el = document.getElementById(elementId);
  const range = document.createRange();
  range.selectNodeContents(el);
  const sel = window.getSelection();
  sel.removeAllRanges();
  sel.addRange(range);
  document.execCommand("copy");
  sel.removeAllRanges();

  const orig = btnElement.textContent;
  btnElement.textContent = '‚úì ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!';
  btnElement.classList.add('copied');
  setTimeout(() => { btnElement.textContent = orig; btnElement.classList.remove('copied'); }, 2000);
}

// ‚îÄ‚îÄ section card ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function createSection(idx, subject, bodyHTML) {
  return `
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">üìß ‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á #${idx}</div>
        <button class="copy-btn" onclick="copyToClipboard('subject${idx}', this)">üìã Copy ‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</button>
      </div>
      <div id="subject${idx}" class="content-box" contenteditable="true">${subject}</div>

      <div class="section-header" style="margin-top:20px;">
        <div class="section-title">üìù ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° #${idx}</div>
        <button class="copy-btn" onclick="copyToClipboard('body${idx}', this)">üìã Copy ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
      </div>
      <div id="body${idx}" class="content-box" contenteditable="true">${bodyHTML}</div>
    </div>`;
}

// ‚îÄ‚îÄ Webex List Daily ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function createWebexList(dateFormatted, incMgt, incProd, prodCount, uatCount) {
  let t = `Webex List Daily | ${dateFormatted}\n----------------- Daily Webex -----------------\n\n`;
  let n = 1;                              // running #

  // Mgt ‚Üí #1
  t += `${incMgt}\nWebex #${n} ‡∏Ç‡∏≤ Manage ECS Monitoring ‡∏Ñ‡∏£‡∏±‡∏ö\nURL${n}\n\n`;
  n++;

  // Daily PROD ‚Üí ‡∏≠‡∏±‡∏ô‡∏ó‡∏µ‡πà 1-2 ‡∏Ç‡∏≠‡∏á PROD (‡∏Ñ‡∏∑‡∏≠ #2, #3)
  for (let i = 1; i <= Math.min(2, prodCount); i++, n++) {
    t += `WebEx PROD #${n} : ${incProd[i]} ‡∏Ñ‡∏£‡∏±‡∏ö\nURL${n}\n\n`;
  }

  // Spare PROD ‚Üí ‡∏≠‡∏±‡∏ô‡∏ó‡∏µ‡πà 3 ‡πÄ‡∏•‡∏¢‡πÑ‡∏õ
  if (prodCount > 2) {
    t += `----------------- Spare Webex -----------------\n\n`;
    for (let i = 3; i <= prodCount; i++, n++) {
      t += `WebEx PROD #${n} : ${incProd[i]} ‡∏Ñ‡∏£‡∏±‡∏ö\nURL${n}\n\n`;
    }
  }

  // UAT ‚Üí ‡∏ô‡∏±‡∏ö‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å PROD
  if (uatCount > 0) {
    t += `----------------- UAT Webex -----------------\n\n`;
    for (let u = 1; u <= uatCount; u++, n++) {
      t += `WebEx UAT #${n} ‡∏Ñ‡∏£‡∏±‡∏ö\nURL${n}\n\n`;
    }
  }

  return t.trimEnd();
}

// ‚îÄ‚îÄ init ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
document.getElementById('dateInput').valueAsDate = new Date();
updateIncInputs();

// ‚îÄ‚îÄ generate ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function generateText() {
  const dateRaw = document.getElementById('dateInput').value;
  if (!dateRaw) { alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏ô"); return; }

  const prodCount = getPROD();
  const uatCount  = getUAT();
  if (getTotal() > 8) { alert("‚ö†Ô∏è ‡∏£‡∏ß‡∏° Mgt + PROD + UAT ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 8 ‡∏≠‡∏±‡∏ô"); return; }

  // validate
  let ok = true;

  const mgtEl = document.getElementById('incMgt');
  if (!mgtEl.value.trim()) { ok = false; mgtEl.style.borderColor = '#ef4444'; }
  else                     { mgtEl.style.borderColor = '#10b981'; }
  const incMgt = mgtEl.value.trim();

  const incProd = [];
  for (let i = 1; i <= prodCount; i++) {
    const el = document.getElementById(`incProd${i}`);
    if (!el.value.trim()) { ok = false; el.style.borderColor = '#ef4444'; }
    else                  { incProd[i] = el.value.trim(); el.style.borderColor = '#10b981'; }
  }

  if (!ok) { alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç INC ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö (Mgt + PROD)"); return; }

  // build
  const dateFormatted = formatDate(dateRaw);
  const timeRange     = `${dateFormatted} 08:00 - 24:00`;
  const hl            = `<span class="highlight">‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏ï‡∏±‡πâ‡∏á Auto Accept Mouse &amp; Keyboard ‡πÉ‡∏´‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö</span>`;

  const sections = [];
  let idx = 1;

  // 1) Mgt
  sections.push(createSection(idx,
    `[KBC] ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô WebEx Production ‡∏Ç‡∏≤ Management ‡πÄ‡∏û‡∏∑‡πà‡∏≠ Support ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ ECS Dashboard Monitoring #${idx}`,
    `‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ó‡∏µ‡∏° Monitor<br><br>
Refer Incident: ${incMgt} ‡∏ó‡∏µ‡∏° KBC ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô WebEx Production ‡∏Ç‡∏≤ Management ‡πÄ‡∏û‡∏∑‡πà‡∏≠ Support ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ ECS Dashboard Monitoring ${timeRange} ${hl}`
  ));
  idx++;

  // 2) PROD
  for (let i = 1; i <= prodCount; i++, idx++) {
    sections.push(createSection(idx,
      `[KBC] ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô WebEx ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Ref. ${incProd[i]} #${idx}`,
      `‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ó‡∏µ‡∏° Monitor<br><br>
Refer Incident: ${incProd[i]} ‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏Ç‡∏≠ WebEx ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ ${timeRange} Wintel-KBC support ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ${hl}`
    ));
  }

  // 3) UAT
  for (let u = 1; u <= uatCount; u++, idx++) {
    sections.push(createSection(idx,
      `[KBC] ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô WebEx UAT (Service IP) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö ECE #${idx}`,
      `‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ó‡∏µ‡∏° Monitor<br><br>
Request WebEx UAT (Service IP) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö ECE ‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ ${timeRange} ‡∏ô. Wintel-KBC support ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ${hl}`
    ));
  }

  // 4) Webex List Daily
  sections.push(`
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">üìä Webex List Daily</div>
        <button class="copy-btn" onclick="copyToClipboard('webexList', this)">üìã Copy ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
      </div>
      <div id="webexList" class="content-box webex-list" contenteditable="true">${createWebexList(dateFormatted, incMgt, incProd, prodCount, uatCount)}</div>
    </div>`);

  const out = document.getElementById('outputArea');
  out.innerHTML = sections.join('');
  out.classList.add('show');
  out.scrollIntoView({ behavior:'smooth', block:'start' });
}
</script>
</body>
</html>
